Code written by Gorazd Dimitrov and Maayane Attias jointly (uploaded by Gorazd because of technical issues).
